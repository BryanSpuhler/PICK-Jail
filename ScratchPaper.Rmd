
## R Markdown
```{r}
Jail_clean %>% 
    furniture::tableF(Div_Dich)
```

```{r}
Jail_clean %>% 
    furniture::tableF(Div_Dich)
```

```{r}
Jail_clean %>% 
    mutate(Div_DichF = factor(Div_Dich))

class(Jail_clean$Div_DichF)

```


```{r}
class(Jail_clean$Div_Dich)
```


```{r}
cbind(Jail_raw$HappyPerson,Jail_clean$HappyPerson.n)





str(DivorcedYou)
```


```{r}
dplyr::left_join(Jail_raw %>% 
                     dplyr::select(ID,
                                   HappyPerson, 
                                   SatisfiedLife, 
                                   SatisfiedRelationship, 
                                   FeelLovedWanted, 
                                   RelationshipsFullComplete) %>% 
                     dplyr::mutate(HappyPerson = as.numeric(factor(HappyPerson)) - 1, 
                                   SatisfiedLife = as.numeric(factor(SatisfiedLife))  - 1, 
                                   SatisfiedRelationship = as.numeric(factor(SatisfiedRelationship)) - 1, 
                                   FeelLovedWanted = as.numeric(factor(FeelLovedWanted)) - 1, 
                                   RelationshipsFullComplete = as.numeric(factor(RelationshipsFullComplete)) - 1),
                 Jail_clean %>% 
                     dplyr::select(ID,
                                   HappyPerson.n, 
                                   SatisfiedLife.n, 
                                   SatisfiedRelationship.n, 
                                   FeelLovedWanted.n, 
                                   RelationshipsFullComplete.n),
                 by = "ID") %>% 
    dplyr::mutate(test1 = HappyPerson - HappyPerson.n,
                  test2 = SatisfiedLife - SatisfiedLife.n,
                  test3 = SatisfiedRelationship - SatisfiedRelationship.n,
                  test4 = FeelLovedWanted - FeelLovedWanted.n,
                  test5 = RelationshipsFullComplete - RelationshipsFullComplete.n) %>% 
    dplyr::arrange(-test3)
                     
```



```{r}


Jail_raw %>% 
    dplyr::filter(ID == 7223.1000) %>% 
    dplyr::select(ID, PWB_Summed, HappyPerson, 
                                   SatisfiedLife, 
                                   SatisfiedRelationship, 
                                   FeelLovedWanted, 
                                   RelationshipsFullComplete)


Jail_clean%>% 
    dplyr::filter(ID == 7223.1000) %>% 
    dplyr::select(ID, PWB_Summed2, HappyPerson.n, 
                                   SatisfiedLife.n, 
                                   SatisfiedRelationship.n, 
                                   FeelLovedWanted.n, 
                                   RelationshipsFullComplete.n)

```


```{r}
Jail_raw %>% furniture::tableF(SatisfiedLife)
```



```{r}
Jail_raw %>% 
    dplyr::mutate(BL_T1.1 = dgen::row_mean(LoveSufficientMarriage_T1,
                                                      LoveEnoughSustain_T1,
                                                      FoolWalksAway_T1,
                                                      maxmiss_n = 1))
```

```{r}
Jail_clean %>% 
    furniture::tableF(LoveSufficientMarriage_T1.n)

Jail_clean %>% 
    furniture::tableF(LoveEnoughSustain_T1.n)

Jail_clean %>% 
    furniture::tableF(FoolWalksAway_T1.n)

Jail_clean %>% 
    furniture::tableF(BL_T1)

Jail_clean %>% 
    furniture::tableF(LoveSufficientMarriage_T2.n)

Jail_clean %>% 
    furniture::tableF(LoveEnoughSustain_T2.n)

Jail_clean %>% 
    furniture::tableF(FoolWalksAway_T2.n)

Jail_clean %>% 
    furniture::tableF(BL_T2)
```

```{r}
Jail_clean %>% 
    furniture::tableF(PaceRelationshipSafe.n)

Jail_clean %>% 
    furniture::tableF(SpotWarningSigns.n)

Jail_clean %>% 
    furniture::tableF(WeighProsCons.n)

Jail_clean %>% 
    furniture::tableF(VF_Scale_T1)

Jail_clean %>% 
    furniture::tableF(PaceRelationshipSafe_After.n)

Jail_clean %>% 
    furniture::tableF(SpotWarningSigns_After.n)

Jail_clean %>% 
    furniture::tableF(WeighProsCons_After.n)

Jail_clean %>% 
    furniture::tableF(VF_Scale_After)
```

```{r}
Jail_clean %>% 
    furniture::tableF(KeepPartnerDoing_T1.n)

Jail_clean %>% 
    furniture::tableF(ForbidPartnerTalking_T1.n)

Jail_clean %>% 
    furniture::tableF(WouldNotStay_T1.n)

Jail_clean %>% 
    furniture::tableF(Control_Scale_T1)

Jail_clean %>% 
    furniture::tableF(KeepPartnerDoing_T2.n)

Jail_clean %>% 
    furniture::tableF(ForbidPartnerTalking_T2.n)

Jail_clean %>% 
    furniture::tableF(WouldNotStay_T2.n)

Jail_clean %>% 
    furniture::tableF(Control_Scale_T2)
```

dplyr::mutate(Control_Scale_T1 = dgen::row_mean(KeepPartnerDoing_T1.n,
                                                            ForbidPartnerTalking_T1.n,
                                                            WouldNotStay_T1.n,
                                                            maxmiss_n = 1)) %>% 
        
    dplyr::mutate(Control_Scale_T2 = dgen::row_mean(KeepPartnerDoing_T2.n,
                                                            ForbidPartnerTalking_T2.n,
                                                            WouldNotStay_T2.n,
                                                            maxmiss_n = 1)) %>%   



```{r}
library(Amelia)
```

# Save an object to a file
saveRDS(Jail_clean, file = "Jail_clean.rds")

# Restore the object
readRDS(file = "my_data.rds")


# Saving on object in RData format
save(Jail_clean, file = "Jail_clean.RData")
# Save multiple objects
save(data1, data2, file = "data.RData")
# To load the data again
load("data.RData")

```{r}
summary(Jail_clean)
```

```{r}
library(haven)

write_sav(Jail_clean, "C:/Users/a00555353.AGGIES/Box Sync/Extension Research/Current Projects/Inmate Research/PICK Jail Pilot/Pick_Jail_R", compress=FALSE )
```

```{r}
dplyr::mutate(miss.change = dgen::row_nmiss(BL_Change,
                                                VF_Change,
                                                Control_Change)) %>% 
    
    dplyr::mutate(miss.pre = dgen::row_nmiss(BL_T1, 
                                               VF_Scale_T1, 
                                               Control_Scale_T1)) %>%   
    
    dplyr::mutate(miss.post = dgen::row_nmiss(BL_T2, 
                                               VF_Scale_After, 
                                               Control_Scale_T2)) %>% 

    dplyr::mutate(miss.scores = dgen::row_nmiss(BL_T1, 
                                               VF_Scale_T1, 
                                               Control_Scale_T1,
                                                BL_T2, 
                                               VF_Scale_After, 
                                               Control_Scale_T2)) %>% 
    
    dplyr::mutate(at.least.one.score = ifelse(miss.scores == 6, NA, 1)) %>% 
    
    dplyr::mutate(at.least.one.change.score = ifelse(miss.change == 3, NA, 1)) %>% 
        
   
     dplyr::mutate(in.analysis.sample1 = complete.cases(
                at.least.one.change.score,
                  Age, 
                  Ethnicity, 
                  Education,
                  RelEd_Dich,
                  FinancialWorry_cat,
                  Gender,
                  PWB_Summed,
                  Div_Dich
        )) %>% 

    

        dplyr::mutate(in.analysis.sample2 = complete.cases(
                at.least.one.change.score,
                  Age, 
                  Ethnicity, 
                  Education,
                  RelEd_Dich,
                  FinancialWorry_cat,
                  Gender,
                  #PWB_Summed,
                  Div_Dich
        )) %>% 
    
       
    
     dplyr::mutate(in.analysis.sample3 = complete.cases(
                at.least.one.change.score,
                  Age, 
                  Ethnicity, 
                  Education,
                  RelEd_Dich,
                  FinancialWorry_cat,
                  Gender,
                  PWB_Summed
                  #Div_Dich
                
        )) %>% 
    
            dplyr::mutate(Missing.preds = dgen::row_nmiss(Age,
                  Ethnicity,
                  Education,
                  RelEd_Dich,
                  FinancialWorry_cat,
                  Gender,
                  PWB_Summed,
                  Div_Dich))
```

```{r}
Jail_clean %>% dplyr::filter(in.analysis.sample1 == TRUE) %>% furniture::tableF(KeepPartnerDoing_T2) 
Jail_clean %>% dplyr::filter(in.analysis.sample1 == TRUE) %>% furniture::tableF(KeepPartnerDoing_T2.n)
Jail_clean %>% dplyr::filter(in.analysis.sample1 == TRUE) %>% furniture::tableF(ForbidPartnerTalking_T2)
Jail_clean %>% dplyr::filter(in.analysis.sample1 == TRUE) %>% furniture::tableF(ForbidPartnerTalking_T2.n)
Jail_clean %>% dplyr::filter(in.analysis.sample1 == TRUE) %>% furniture::tableF(WouldNotStay_T2)
Jail_clean %>% dplyr::filter(in.analysis.sample1 == TRUE) %>% furniture::tableF(WouldNotStay_T2.n)



```

   
```{r}
dplyr::glimpse(Jail_clean)
```

```{r}
Jail_clean %>%
    dplyr::filter(in.analysis.sample3 == FALSE) %>%
    dplyr::filter(Missing.preds == 1) %>%
    dplyr::select(at.least.one.change.score,
                  Age, 
                  Ethnicity, 
                  Education,
                  RelEd_Dich,
                  FinancialWorry_cat,
                  Gender,
                  PWB_Summed2,
                  WAI,
                  Married_Dich) %>%

    furniture::table1(na.rm = FALSE,
                      digits = 2,
                      # splitby = ~ in.analysis.sample1,
                      test = TRUE) %>% pander::pander()


```